<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Renders - Darshan Shah</title>
  <link rel="icon" type="image/png" href="assets/Ds.png">
  <link rel="stylesheet" href="styles.css?v=4" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
</head>
<body>
  <main>
    <header>
      <h1><a href="index.html" style="color: inherit; text-decoration: none;">Darshan Shah.</a></h1>
      <p class="tagline">my 3d renders and creations.</p>
    </header>

    <section>
      <h2>renders</h2>
      <div class="renders-gallery">
        
        <!-- Donut Series (grouped) -->
        <div class="render-card" data-group="donut" data-assets='["assets/Donut3.png", "assets/donut4.png", "assets/donut5.png", "assets/cup.png"]' data-title="Donut Series">
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <img src="assets/Donut3.png" alt="Donut Render" class="render-image active">
              <img src="assets/donut4.png" alt="Donut Render" class="render-image">
              <img src="assets/donut5.png" alt="Donut Render" class="render-image">
              <img src="assets/cup.png" alt="Donut Render" class="render-image">
            </div>
            <div class="render-overlay">
              <span class="render-title">Donut Series</span>
            </div>
          </div>
        </div>

        <!-- Lightsaber Series (grouped, video priority) -->
        <div class="render-card" data-group="lightsaber" data-assets='["assets/lightsabervid.mp4", "assets/lightsaber1.png", "assets/lightsaber2.png"]' data-title="Lightsaber Series" data-types='["video", "image", "image"]'>
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <video src="assets/lightsabervid.mp4" autoplay loop muted playsinline class="render-image active render-video"></video>
              <img src="assets/lightsaber1.png" alt="Lightsaber Render" class="render-image">
              <img src="assets/lightsaber2.png" alt="Lightsaber Render" class="render-image">
            </div>
            <div class="render-overlay">
              <span class="render-title">Lightsaber Series</span>
            </div>
          </div>
        </div>

        <!-- Half House Series (grouped) -->
        <div class="render-card" data-group="halfhouse" data-assets='["assets/halfhouse.png", "assets/halfhouse2.png", "assets/halfhouse3.png", "assets/halfhouse4.png", "assets/halfhouse5.png"]' data-title="Half House Series">
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <img src="assets/halfhouse.png" alt="Half House Render" class="render-image active">
              <img src="assets/halfhouse2.png" alt="Half House Render" class="render-image">
              <img src="assets/halfhouse3.png" alt="Half House Render" class="render-image">
              <img src="assets/halfhouse4.png" alt="Half House Render" class="render-image">
              <img src="assets/halfhouse5.png" alt="Half House Render" class="render-image">
            </div>
            <div class="render-overlay">
              <span class="render-title">Half House Series</span>
            </div>
          </div>
        </div>

        <!-- Poly Island (grouped, video priority) -->
        <div class="render-card" data-group="polyisland" data-assets='["assets/polyisland.mov", "assets/polyisland1.png"]' data-title="Poly Island" data-types='["video", "image"]'>
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <video src="assets/polyisland.mov" autoplay loop muted playsinline class="render-image active render-video"></video>
              <img src="assets/polyisland1.png" alt="Poly Island Render" class="render-image">
            </div>
            <div class="render-overlay">
              <span class="render-title">Poly Island</span>
            </div>
          </div>
        </div>

        <!-- Rubik's Cube (single) -->
        <div class="render-card" data-group="rubiks" data-assets='["assets/RubiksCubeModel.png"]' data-title="Rubik's Cube">
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <img src="assets/RubiksCubeModel.png" alt="Rubik's Cube Render" class="render-image active">
            </div>
            <div class="render-overlay">
              <span class="render-title">Rubik's Cube</span>
            </div>
          </div>
        </div>

        <!-- Soldier (single) -->
        <div class="render-card" data-group="soldier" data-assets='["assets/solider.png"]' data-title="R & B Soldier Environment">
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <img src="assets/solider.png" alt="R & B Soldier Environment" class="render-image active">
            </div>
            <div class="render-overlay">
              <span class="render-title">R & B Soldier Environment</span>
            </div>
          </div>
        </div>

        <!-- Orbit Mouse (single) -->
        <div class="render-card" data-group="orbitmouse" data-assets='["assets/orbitmouse.png"]' data-title="Orbit Mouse">
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <img src="assets/orbitmouse.png" alt="Orbit Mouse Render" class="render-image active">
            </div>
            <div class="render-overlay">
              <span class="render-title">Orbit Mouse</span>
            </div>
          </div>
        </div>

        <!-- Shoe Knife (grouped, video priority) -->
        <div class="render-card" data-group="shoeknife" data-assets='["assets/ShoeKnifeCompleteVid.mp4"]' data-title="Shoe Knife" data-types='["video"]'>
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <video src="assets/ShoeKnifeCompleteVid.mp4" autoplay loop muted playsinline class="render-image active render-video"></video>
            </div>
            <div class="render-overlay">
              <span class="render-title">Shoe Knife</span>
            </div>
          </div>
        </div>

        <!-- Skateboard (single, video) -->
        <div class="render-card" data-group="skateboard" data-assets='["assets/skateboardvid.mkv"]' data-title="Skateboard" data-types='["video"]'>
          <div class="render-image-wrapper">
            <div class="render-carousel">
              <video src="assets/skateboardvid.mp4" autoplay loop muted playsinline class="render-image active render-video"></video>
            </div>
            <div class="render-overlay">
              <span class="render-title">Skateboard</span>
            </div>
          </div>
        </div>

      </div>
    </section>

    <footer>
      <p>Â© <span id="year"></span> Darshan Shah</p>
    </footer>
  </main>

  <div class="cursor-blob"></div>

  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();
   
    // --- Scroll Glow + Fade-in ---
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('glow', 'visible');
        else entry.target.classList.remove('glow', 'visible');
      });
    }, { threshold: 0.3 });
   
    document.querySelectorAll('h2, .render-card').forEach(el => observer.observe(el));
  
    // --- Progress Bar ---
    const progress = document.createElement('div');
    progress.id = 'progress';
    document.body.appendChild(progress);
    window.addEventListener('scroll', () => {
      const docHeight = document.body.scrollHeight - window.innerHeight;
      const pct = (window.scrollY / docHeight) * 100;
      progress.style.width = pct + '%';
    });
  
    // --- Soft Gradient Blob (colour accent) ---
    const blob = document.querySelector('.cursor-blob');
    window.addEventListener('mousemove', e => {
      blob.style.transform = `translate(${e.clientX - 100}px, ${e.clientY - 100}px)`;
    });

    // --- Hover Carousel ---
    const renderCards = document.querySelectorAll('.render-card');
    let hoverIntervals = new Map();
    let hoverTimeouts = new Map();

    renderCards.forEach(card => {
      const carousel = card.querySelector('.render-carousel');
      const images = carousel.querySelectorAll('.render-image, .render-video');
      if (images.length <= 1) return;

      let currentIndex = 0;
      let interval = null;

      // Pause video when not active
      const pauseInactiveVideos = () => {
        images.forEach((img, idx) => {
          if (img.tagName === 'VIDEO' && idx !== currentIndex) {
            img.pause();
          }
        });
      };

      const showImage = (index) => {
        images.forEach((img, idx) => {
          img.classList.remove('active');
          if (idx === index) {
            img.classList.add('active');
            if (img.tagName === 'VIDEO') {
              img.currentTime = 0;
              img.play().catch(() => {});
            }
          } else if (img.tagName === 'VIDEO') {
            img.pause();
          }
        });
      };

      card.addEventListener('mouseenter', () => {
        // Clear any existing timeout
        if (hoverTimeouts.has(card)) {
          clearTimeout(hoverTimeouts.get(card));
        }
        
        // Start carousel after a brief delay
        const timeout = setTimeout(() => {
          currentIndex = 0;
          interval = setInterval(() => {
            currentIndex = (currentIndex + 1) % images.length;
            showImage(currentIndex);
          }, 2000); // Change image every 2 seconds
          hoverIntervals.set(card, interval);
        }, 500);
        
        hoverTimeouts.set(card, timeout);
      });

      card.addEventListener('mouseleave', () => {
        if (hoverTimeouts.has(card)) {
          clearTimeout(hoverTimeouts.get(card));
          hoverTimeouts.delete(card);
        }
        if (hoverIntervals.has(card)) {
          clearInterval(hoverIntervals.get(card));
          hoverIntervals.delete(card);
        }
        // Reset to first image
        currentIndex = 0;
        showImage(0);
      });
    });

    // --- Modal Carousel ---
    renderCards.forEach(card => {
      card.addEventListener('click', () => {
        const assets = JSON.parse(card.dataset.assets || '[]');
        const types = card.dataset.types ? JSON.parse(card.dataset.types) : new Array(assets.length).fill('image');
        const title = card.dataset.title || 'Render';
        
        if (assets.length === 0) return;

        let currentModalIndex = 0;
        
        const modal = document.createElement('div');
        modal.className = 'render-modal';
        
        const createMediaElement = (src, type) => {
          if (type === 'video') {
            const video = document.createElement('video');
            video.src = src;
            video.controls = true;
            video.autoplay = false;
            video.loop = true;
            video.muted = true;
            video.playsInline = true;
            video.className = 'render-modal-media render-modal-video';
            return video;
          } else {
            const img = document.createElement('img');
            img.src = src;
            img.alt = title;
            img.className = 'render-modal-media render-modal-image';
            return img;
          }
        };

        const updateModalContent = () => {
          const mediaContainer = modal.querySelector('.render-modal-media-container');
          const existingMedia = mediaContainer.querySelector('.render-modal-media');
          
          // Fade out existing media
          if (existingMedia) {
            existingMedia.style.opacity = '0';
            existingMedia.style.transition = 'opacity 0.2s ease';
            
            setTimeout(() => {
              mediaContainer.innerHTML = '';
              const media = createMediaElement(assets[currentModalIndex], types[currentModalIndex]);
              media.style.opacity = '0';
              media.style.transition = 'opacity 0.3s ease';
              mediaContainer.appendChild(media);
              
              // Fade in new media
              setTimeout(() => {
                media.style.opacity = '1';
              }, 10);
              
              // Adjust modal size based on image aspect ratio after load
              const adjustModalSize = () => {
                const mediaElement = modal.querySelector('.render-modal-media');
                const modalContent = modal.querySelector('.render-modal-content');
                
                if (!mediaElement || !modalContent) return;
                
                let naturalWidth, naturalHeight;
                
                if (mediaElement.tagName === 'IMG') {
                  naturalWidth = mediaElement.naturalWidth || mediaElement.offsetWidth;
                  naturalHeight = mediaElement.naturalHeight || mediaElement.offsetHeight;
                } else if (mediaElement.tagName === 'VIDEO') {
                  naturalWidth = mediaElement.videoWidth || mediaElement.offsetWidth;
                  naturalHeight = mediaElement.videoHeight || mediaElement.offsetHeight;
                }
                
                if (naturalWidth && naturalHeight && naturalWidth > 0 && naturalHeight > 0) {
                  const aspectRatio = naturalWidth / naturalHeight;
                  const maxWidth = window.innerWidth * 0.9;
                  const maxHeight = (window.innerHeight * 0.9) - 80; // Account for smaller header
                  
                  let targetWidth, targetHeight;
                  
                  if (aspectRatio >= 1) {
                    // Landscape or square
                    targetWidth = Math.min(maxWidth, maxHeight * aspectRatio);
                    targetHeight = targetWidth / aspectRatio;
                  } else {
                    // Portrait
                    targetHeight = Math.min(maxHeight, maxWidth / aspectRatio);
                    targetWidth = targetHeight * aspectRatio;
                  }
                  
                  modalContent.style.width = (targetWidth + 2) + 'px';
                  modalContent.style.maxHeight = '90vh';
                  modalContent.style.transition = 'width 0.3s ease';
                }
              };
              
              // Wait for media to load
              if (media.tagName === 'IMG') {
                if (media.complete && media.naturalWidth > 0) {
                  setTimeout(adjustModalSize, 10);
                } else {
                  media.addEventListener('load', () => {
                    setTimeout(adjustModalSize, 10);
                  }, { once: true });
                }
              } else if (media.tagName === 'VIDEO') {
                if (media.readyState >= 2) {
                  setTimeout(adjustModalSize, 10);
                } else {
                  media.addEventListener('loadedmetadata', () => {
                    setTimeout(adjustModalSize, 10);
                  }, { once: true });
                }
              }
            }, 200);
          } else {
            // First load
            const media = createMediaElement(assets[currentModalIndex], types[currentModalIndex]);
            media.style.opacity = '0';
            media.style.transition = 'opacity 0.3s ease';
            mediaContainer.appendChild(media);
            
            setTimeout(() => {
              media.style.opacity = '1';
            }, 10);
            
            // Adjust modal size
            const adjustModalSize = () => {
              const mediaElement = modal.querySelector('.render-modal-media');
              const modalContent = modal.querySelector('.render-modal-content');
              
              if (!mediaElement || !modalContent) return;
              
              let naturalWidth, naturalHeight;
              
              if (mediaElement.tagName === 'IMG') {
                naturalWidth = mediaElement.naturalWidth || mediaElement.offsetWidth;
                naturalHeight = mediaElement.naturalHeight || mediaElement.offsetHeight;
              } else if (mediaElement.tagName === 'VIDEO') {
                naturalWidth = mediaElement.videoWidth || mediaElement.offsetWidth;
                naturalHeight = mediaElement.videoHeight || mediaElement.offsetHeight;
              }
              
              if (naturalWidth && naturalHeight && naturalWidth > 0 && naturalHeight > 0) {
                const aspectRatio = naturalWidth / naturalHeight;
                const maxWidth = window.innerWidth * 0.9;
                const maxHeight = (window.innerHeight * 0.9) - 80;
                
                let targetWidth, targetHeight;
                
                if (aspectRatio >= 1) {
                  targetWidth = Math.min(maxWidth, maxHeight * aspectRatio);
                  targetHeight = targetWidth / aspectRatio;
                } else {
                  targetHeight = Math.min(maxHeight, maxWidth / aspectRatio);
                  targetWidth = targetHeight * aspectRatio;
                }
                
                modalContent.style.width = (targetWidth + 2) + 'px';
                modalContent.style.maxHeight = '90vh';
              }
            };
            
            if (media.tagName === 'IMG') {
              if (media.complete && media.naturalWidth > 0) {
                setTimeout(adjustModalSize, 10);
              } else {
                media.addEventListener('load', () => {
                  setTimeout(adjustModalSize, 10);
                }, { once: true });
              }
            } else if (media.tagName === 'VIDEO') {
              if (media.readyState >= 2) {
                setTimeout(adjustModalSize, 10);
              } else {
                media.addEventListener('loadedmetadata', () => {
                  setTimeout(adjustModalSize, 10);
                }, { once: true });
              }
            }
          }
        };

        modal.innerHTML = `
          <div class="render-modal-content">
            <div class="render-modal-header">
              <h3 class="render-modal-title">${title}</h3>
              <div class="render-modal-header-right">
                ${assets.length > 1 ? `<span class="render-modal-counter">${currentModalIndex + 1} / ${assets.length}</span>` : ''}
                <span class="render-modal-close">&times;</span>
              </div>
            </div>
            <div class="render-modal-body">
              ${assets.length > 1 ? '<button class="render-modal-nav render-modal-prev">&lt;</button>' : ''}
              <div class="render-modal-media-container">
                ${createMediaElement(assets[0], types[0]).outerHTML}
              </div>
              ${assets.length > 1 ? '<button class="render-modal-nav render-modal-next">&gt;</button>' : ''}
            </div>
          </div>
        `;
        
        document.body.appendChild(modal);
        document.body.style.overflow = 'hidden';
        
        updateModalContent();

        const showNext = () => {
          currentModalIndex = (currentModalIndex + 1) % assets.length;
          updateModalContent();
          const counter = modal.querySelector('.render-modal-counter');
          if (counter) counter.textContent = `${currentModalIndex + 1} / ${assets.length}`;
        };

        const showPrev = () => {
          currentModalIndex = (currentModalIndex - 1 + assets.length) % assets.length;
          updateModalContent();
          const counter = modal.querySelector('.render-modal-counter');
          if (counter) counter.textContent = `${currentModalIndex + 1} / ${assets.length}`;
        };

        if (assets.length > 1) {
          modal.querySelector('.render-modal-next').addEventListener('click', showNext);
          modal.querySelector('.render-modal-prev').addEventListener('click', showPrev);
          
          // Keyboard navigation
          const handleKeyPress = (e) => {
            if (e.key === 'ArrowRight') showNext();
            if (e.key === 'ArrowLeft') showPrev();
            if (e.key === 'Escape') closeModal();
          };
          window.addEventListener('keydown', handleKeyPress);
          
          // Store handler for cleanup
          modal._keyHandler = handleKeyPress;
        }
        
        const closeModal = () => {
          if (modal._keyHandler) {
            window.removeEventListener('keydown', modal._keyHandler);
          }
          document.body.removeChild(modal);
          document.body.style.overflow = '';
        };
        
        const closeBtn = modal.querySelector('.render-modal-close');
        if (closeBtn) {
          closeBtn.addEventListener('click', closeModal);
        }
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            closeModal();
          }
        });
      });
    });
  </script>

  <style>
    #progress {
      position: fixed;
      top: 0;
      left: 0;
      height: 2px;
      background: linear-gradient(to right, #6791c0, #c06791);
      width: 0%;
      z-index: 999;
      transition: width 0.1s linear;
    }
  </style>
   
</body>
</html>